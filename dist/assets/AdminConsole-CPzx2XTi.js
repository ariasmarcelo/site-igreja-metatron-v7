import{R as mt,j as e,L as Ke,T as Ue,b as Ye,c as Qe,d as ht,V as gt,e as Ze,I as xt,f as yt,g as et,h as ft,i as tt,k as bt,l as vt,m as st,n as ot,o as at,p as nt}from"./ui-vendor-DAvjFVkr.js";import{r as h}from"./react-vendor-CXofqtSI.js";import{c as k,a as ee,s as Re,A as Le,b as Fe,X as lt,t as jt,d as Nt,B as R,Q as Ct,C as rt,e as ke,f as Ee,F as wt,g as Ge,h as kt,i as Et,j as St,k as Tt,l as He,I as At,m as It,n as $t,q as Vt,o as _t,p as Mt,P as Rt,r as zt,u as Dt,v as Pt,T as Lt,w as Ft,x as Ot,y as Xt}from"./index-vk_93FW4.js";import{u as Bt,i as Gt,a as Ht,b as qt,c as Jt,d as Wt,e as Kt,T as Ut,C as Yt,E as Qt}from"./editor-vendor-Fmayg4Vc.js";import"./supabase-DMvHgohL.js";const Zt=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],es=k("bold",Zt);const ts=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ss=k("check",ts);const os=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],as=k("chevron-up",os);const ns=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ls=k("circle-alert",ns);const rs=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],is=k("circle-check-big",rs);const cs=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ds=k("code",cs);const us=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ps=k("download",us);const ms=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],it=k("eye",ms);const hs=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],gs=k("file-braces",hs);const xs=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],ys=k("heading-1",xs);const fs=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],bs=k("heading-2",fs);const vs=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],js=k("heading-3",vs);const Ns=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],Cs=k("highlighter",Ns);const ws=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ks=k("image",ws);const Es=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Ss=k("italic",Es);const Ts=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],As=k("link",Ts);const Is=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],$s=k("list-ordered",Is);const Vs=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],_s=k("list",Vs);const Ms=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Rs=k("pen-line",Ms);const zs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ds=k("plus",zs);const Ps=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],Ls=k("redo",Ps);const Fs=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ct=k("save",Fs);const Os=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Xs=k("search",Os);const Bs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Gs=k("square-pen",Bs);const Hs=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],qs=k("tag",Hs);const Js=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],Ws=k("text-align-center",Js);const Ks=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],Us=k("text-align-end",Ks);const Ys=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],Qs=k("text-align-start",Ys);const Zs=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],eo=k("trash-2",Zs);const to=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],so=k("underline",to);const oo=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],ao=k("undo",oo);const no=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],lo=k("upload",no),ze=mt,Ie=h.forwardRef(({className:g,...C},s)=>e.jsx(Ke,{ref:s,className:ee("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",g),...C}));Ie.displayName=Ke.displayName;const be=h.forwardRef(({className:g,...C},s)=>e.jsx(Ue,{ref:s,className:ee("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",g),...C}));be.displayName=Ue.displayName;const ve=h.forwardRef(({className:g,...C},s)=>e.jsx(Ye,{ref:s,className:ee("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",g),...C}));ve.displayName=Ye.displayName;const qe=h.forwardRef(({className:g,...C},s)=>e.jsx("textarea",{className:ee("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",g),ref:s,...C}));qe.displayName="Textarea";const ie="https://shadcn-ui-seven-olive.vercel.app",Te={getContent:g=>`${ie}/api/content/${g}`,getStyles:g=>`${ie}/api/styles/${g}`,saveJson:`${ie}/api/save-json`,saveVisualEdits:`${ie}/api/save-visual-edits`,saveStyles:`${ie}/api/save-styles`,getBlogPosts:`${ie}/api/blog-posts`,getBlogPost:g=>`${ie}/api/blog-posts/${g}`,createBlogPost:`${ie}/api/blog-posts`,updateBlogPost:g=>`${ie}/api/blog-posts/${g}`,autoAssignIds:`${ie}/api/auto-assign-ids`,health:`${ie}/health`};function ro({pageComponent:g,pageName:C,pageId:s}){const[F,U]=h.useState(!1),[V,Y]=h.useState([]),[_e,ne]=h.useState(null),[ye,o]=h.useState(null),[z,le]=h.useState(!1),q=h.useRef(!1),T=h.useRef(new Map),D=V.some(E=>E.isModified);h.useEffect(()=>{const E=sessionStorage.getItem("visualEditorMessage");if(E)try{const j=JSON.parse(E);o(j),sessionStorage.removeItem("visualEditorMessage"),setTimeout(()=>o(null),8e3)}catch(j){console.error("Error parsing saved message:",j)}const u=sessionStorage.getItem("visualEditorReturnUrl");u&&u!==window.location.pathname&&(sessionStorage.removeItem("visualEditorReturnUrl"),window.location.href=u)},[]),h.useEffect(()=>{Y([]),T.current.clear(),Re(s,!1)},[s]),h.useEffect(()=>()=>{Re(s,!1),console.log("üßπ Cleanup: lock desativado")},[s]),h.useEffect(()=>{const E="visual-editor-styles";if(!document.getElementById(E)){const l=document.createElement("style");l.id=E,l.textContent=`
        [data-editable] {
          box-sizing: border-box !important;
        }
        [data-editable]:hover {
          position: relative;
          z-index: 1;
        }
        @keyframes slideInFromTop {
          from {
            transform: translateY(-100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .toast-notification {
          animation: slideInFromTop 0.5s ease-out;
        }
      `,document.head.appendChild(l)}if(!F)return;const u=()=>{let l=document.querySelector(".border-4.border-dashed.border-amber-400");if(!l){const n=Array.from(document.querySelectorAll(".space-y-4 > *"));l=n[n.length-1]}if(!l){console.error("‚ùå Page container not found - cannot make elements editable");return}const p=new Set;let d=0;const N={},r={};if(["h1","h2","h3","h4","h5","h6","p","span","a","button","div","section","article","header","footer","nav","li","label","td","th","svg"].forEach(n=>{l.querySelectorAll(n).forEach((A,O)=>{const x=A;if(x.hasAttribute("data-editable")||!x.hasAttribute("data-json-key")&&x.closest('input, textarea, select, [role="navigation"]'))return;let t=!1,m=x.parentElement,v=0;for(;m&&v<10;){const S=m.className||"";if(S.includes("space-y-4")&&(S.includes("bg-amber-50")&&S.includes("border-amber-200")||S.includes("bg-green-50")&&S.includes("border-green-300")||S.includes("bg-blue-50")&&S.includes("border-blue-200"))||S.includes("visual-editor-container")||S.includes("visual-editor-overlay")){t=!0;break}m=m.parentElement,v++}if(t)return;const w=window.getComputedStyle(x);if(w.display==="none"||w.visibility==="hidden"||w.opacity==="0")return;const X=x.getBoundingClientRect();if(X.width===0||X.height===0)return;const re=x.textContent?.trim()||"",J=x.tagName.toLowerCase();let I=x.getAttribute("data-json-key");if(!I&&(J==="div"||J==="section"||J==="article"||J==="header"||J==="footer"))return;if(I&&I.includes("subtitle"),I&&p.has(I)){const S=I;r[S]=(r[S]||1)+1,I=`${S}_dup_${r[S]}`,console.log(`üîÑ Duplicate JSON key detected: "${S}" ‚Üí "${I}"`)}if(!I)if(J==="svg"){const S=x.getAttribute("data-icon-name");if(S){const B=`icons.${S.replace(/[^a-z0-9]/gi,"_")}`;p.has(B)?(N[B]=(N[B]||1)+1,I=`${B}_${N[B]}`):I=B}else{const B=x.className,se=(typeof B=="string"?B:B.baseVal||"").match(/lucide-([a-z-]+)/);if(se){const Z=`icons.lucide_${se[1].replace(/-/g,"_")}`;p.has(Z)?(N[Z]=(N[Z]||1)+1,I=`${Z}_${N[Z]}`):I=Z}else I=`icons.svg_${O}`}}else{const S=re.substring(0,30).replace(/[^a-z0-9]/gi,"_");I=`${s}_${J}_${S}_${O}`}p.add(I),x.setAttribute("data-editable",I),d++;const he=V.find(S=>S.key===I);if(he&&he.currentValue&&(x.textContent=he.currentValue),J==="svg"){const S=`${I}.styles`,te=`${I}__styles`,$=V.find(se=>se.key===S||se.key===te)?.currentValue;if($)try{const se=JSON.parse($);Object.entries(se).forEach(([ce,Z])=>{x.style.setProperty(ce,Z)}),console.log("üé® Applied saved SVG styles to:",I,se)}catch(se){console.error("Error parsing SVG styles:",se)}}console.log(`‚úì Made editable [${d}]:`,J,"‚Üí",re.substring(0,50),"| JSON key:",I)})}),console.log(`üìù Total editable elements found: ${d}`),V.length===0){const n=[];document.querySelectorAll("[data-editable]").forEach(c=>{const A=c.getAttribute("data-editable");if(A){const O=c,x=O.textContent||"";n.push({key:A,originalValue:x,currentValue:x,isModified:!1});const Q=O.getAttribute("style");if(Q&&Q.trim()!==""){const t={};Q.split(";").forEach(w=>{const[X,re]=w.split(":").map(J=>J.trim());X&&re&&(t[X]=re)});const m=JSON.stringify(t),v=`${A}__styles`;console.log(`  üé® Capturando estilos para [${A}]:`,t),n.push({key:v,originalValue:m,currentValue:m,isModified:!1})}}}),Y(n)}};setTimeout(()=>{u()},500);const j=l=>{const p=l.target;if(document.querySelector(".visual-editor-textarea"))return;let d=p;const N=[];for(;d&&d!==document.body;)d.hasAttribute("data-editable")&&N.push(d),d=d.parentElement;N.length>0&&console.log(`üéØ Found ${N.length} editable candidates:`,N.map(f=>({tag:f.tagName,id:f.getAttribute("data-editable"),jsonKey:f.getAttribute("data-json-key"),text:f.textContent?.substring(0,30)})));let r=N[0];if(N.length>1){const f=N.find(n=>n.hasAttribute("data-json-key"));f&&(r=f)}if(r){l.preventDefault(),l.stopPropagation();const f=r.getAttribute("data-editable");if(!f)return;V.find(a=>a.key===f),ne(f),r.textContent;const n=document.createElement("div");n.className="visual-editor-overlay",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.style.backgroundColor="rgba(0, 0, 0, 0.5)",n.style.zIndex="9998",n.style.backdropFilter="blur(2px)";const c=r.getBoundingClientRect(),A=window.scrollY,O=window.scrollX,x=document.createElement("div");x.className="visual-editor-container",x.style.position="absolute",x.style.top=`${c.top+A-60}px`,x.style.left=`${c.left+O}px`,x.style.width=`${Math.max(c.width,300)}px`,x.style.zIndex="9999",x.style.backgroundColor="white",x.style.borderRadius="8px",x.style.boxShadow="0 10px 40px rgba(0,0,0,0.3)",x.style.padding="12px";const Q=window.getComputedStyle(r),t=r.tagName.toLowerCase()==="svg";let m=r.getAttribute("data-icon-name"),v=r.getAttribute("data-icon-type");if(t&&!m){const a=r,y=(typeof a.className=="string"?a.className:a.className.baseVal).match(/lucide-([a-z-]+)/);y?(m=y[1].split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "),v="lucide-icon"):(m="√çcone SVG",v="custom-svg")}const w=document.createElement("div");w.style.fontSize="14px",w.style.fontWeight="bold",w.style.color="#333",w.style.marginBottom="12px",w.style.borderBottom="2px solid #CFAF5A",w.style.paddingBottom="8px",t&&m?w.innerHTML=`
            <div style="display: flex; align-items: center; gap: 8px;">
              <span>üé® √çcone: ${m}</span>
              ${v?`<span style="font-size: 11px; color: #666;">(${v})</span>`:""}
            </div>
          `:w.textContent=`Editor Completo: ${r.tagName.toLowerCase()}`;const X=document.createElement("div");X.style.display="flex",X.style.gap="4px",X.style.marginBottom="12px";const re=(a,b=!1)=>{const y=document.createElement("button");return y.textContent=a,y.style.padding="6px 12px",y.style.border="none",y.style.borderRadius="4px",y.style.cursor="pointer",y.style.fontSize="11px",y.style.fontWeight="600",y.style.backgroundColor=b?"#CFAF5A":"#e5e7eb",y.style.color=b?"white":"#666",y},J=re("Texto",!0),I=re("Estilo"),he=re("Layout"),S=re("Avan√ßado");X.appendChild(J),X.appendChild(I),X.appendChild(he),X.appendChild(S);const te=document.createElement("div");te.style.maxHeight="400px",te.style.overflowY="auto",te.style.marginBottom="12px";const B=document.createElement("div");let $;if(t&&m){r.getAttribute("viewBox");const b=Q.width,y=Q.height,_=Q.fill||"none",i=Q.stroke||"none",G=document.createElement("div");G.style.padding="12px",G.style.backgroundColor="#f9fafb",G.style.borderRadius="4px",G.style.border="1px solid #e5e7eb",G.innerHTML=`
            <div style="margin-bottom: 12px;">
              <strong style="color: #374151;">üì¶ Tipo:</strong> √çcone SVG
            </div>
            <div style="margin-bottom: 12px;">
              <strong style="color: #374151;">üè∑Ô∏è Nome:</strong> ${m}
            </div>
            ${v?`
              <div style="margin-bottom: 12px;">
                <strong style="color: #374151;">üîñ Categoria:</strong> ${v}
              </div>
            `:""}
            <div style="margin-bottom: 12px;">
              <strong style="color: #374151;">üìè Dimens√µes Atuais:</strong> ${b} √ó ${y}
            </div>
            <div style="margin-bottom: 12px;">
              <strong style="color: #374151;">üé® Fill:</strong> <span style="background: ${_}; padding: 2px 8px; border-radius: 3px; border: 1px solid #ccc;">${_}</span>
            </div>
            <div style="margin-bottom: 12px;">
              <strong style="color: #374151;">‚úèÔ∏è Stroke:</strong> <span style="background: ${i}; padding: 2px 8px; border-radius: 3px; border: 1px solid #ccc;">${i}</span>
            </div>
            <div style="padding: 8px; background: #fef3c7; border-left: 3px solid #f59e0b; border-radius: 4px; font-size: 12px; color: #92400e;">
              ‚ÑπÔ∏è <strong>Nota:</strong> √çcones SVG n√£o possuem texto edit√°vel. 
              Use as abas <strong>Estilo</strong> e <strong>Layout</strong> para modificar cor, tamanho e posicionamento.
            </div>
          `,B.appendChild(G),$=document.createElement("textarea"),$.style.display="none"}else{const a=r.getAttribute("data-json-key"),b=Array.from(r.querySelectorAll("[data-json-key]")).filter(_=>{const i=_.getAttribute("data-json-key");return _!==r&&i!==a});if(!a&&b.length>0){const _=document.createElement("div");_.style.padding="12px",_.style.backgroundColor="#fef3c7",_.style.borderRadius="4px",_.style.border="1px solid #f59e0b",_.innerHTML=`
              <div style="margin-bottom: 12px;">
                <strong style="color: #92400e;">üì¶ Container Detectado</strong>
              </div>
              <div style="font-size: 12px; color: #78350f; line-height: 1.6;">
                Este elemento cont√©m <strong>${b.length}</strong> elemento(s) filho(s) edit√°vel(is).<br><br>
                ‚ö†Ô∏è <strong>N√£o √© poss√≠vel editar o texto de um container diretamente.</strong><br><br>
                Para editar o conte√∫do, clique nos elementos individuais dentro deste container.<br><br>
                üí° Voc√™ ainda pode editar os <strong>estilos</strong> (cor de fundo, padding, etc.) nas outras abas.
              </div>
            `,B.appendChild(_),$=document.createElement("textarea"),$.style.display="none",$.value=""}else{$=document.createElement("textarea"),$.className="visual-editor-textarea";const _=V.find(i=>i.key===f);$.value=_?_.currentValue:r.textContent||"",$.style.width="100%",$.style.minHeight=`${Math.max(c.height,80)}px`,$.style.padding="8px",$.style.fontSize="13px",$.style.fontFamily="inherit",$.style.border="2px solid #CFAF5A",$.style.borderRadius="4px",$.style.resize="vertical",$.style.outline="none",B.appendChild($)}}const se=t&&r.classList.contains("animate-spin-slow"),ce=document.createElement("div");if(ce.style.display="none",ce.style.gap="8px",ce.style.flexDirection="column",t){const a=document.createElement("div");a.style.padding="8px",a.style.backgroundColor="#eff6ff",a.style.borderLeft="3px solid #3b82f6",a.style.borderRadius="4px",a.style.fontSize="11px",a.style.color="#1e40af",a.style.marginBottom="12px",se?a.innerHTML=`
              ÔøΩ <strong>√çcone Animado!</strong> Este SVG possui anima√ß√£o CSS.<br>
              Use <code>animationDuration</code> para controlar a velocidade (ex: "10s" = 10 segundos, "5s" = mais r√°pido).<br>
              üí° <code>fill</code> e <code>stroke</code> afetam a cor do √≠cone.
            `:a.innerHTML=`
              ÔøΩüí° <strong>Dica:</strong> As propriedades <code>fill</code> e <code>stroke</code> 
              afetar√£o todos os elementos internos do SVG que n√£o t√™m cores definidas explicitamente.
            `,ce.appendChild(a)}let Z;t?(Z=["fill","stroke","strokeWidth","opacity"],se&&Z.push("animationDuration","animationTimingFunction","animationIterationCount"),Z.push("filter","transform")):Z=["fontSize","fontWeight","fontFamily","lineHeight","color","backgroundColor","opacity"],Z.forEach(a=>{const b=document.createElement("div");b.style.display="flex",b.style.alignItems="center",b.style.gap="8px",b.style.marginBottom="8px";const y=document.createElement("label"),_={animationDuration:"‚è±Ô∏è Dura√ß√£o",animationTimingFunction:"üìà Timing",animationIterationCount:"üîÅ Repeti√ß√µes",fill:"üé® Preenchimento",stroke:"‚úèÔ∏è Contorno",strokeWidth:"üìè Espessura",opacity:"üëª Opacidade",filter:"üîç Filtro",transform:"üîÑ Transforma√ß√£o",fontSize:"üìê Tamanho Fonte",fontWeight:"üí™ Peso Fonte",fontFamily:"üî§ Fam√≠lia Fonte",lineHeight:"üìä Altura Linha",letterSpacing:"‚ÜîÔ∏è Espa√ßamento",color:"üé® Cor Texto",backgroundColor:"üñåÔ∏è Cor Fundo",textAlign:"‚¨ÖÔ∏è Alinhamento",textDecoration:"‚ú® Decora√ß√£o",textTransform:"üî† Transformar"};y.textContent=_[a]||a,y.style.fontSize="11px",y.style.fontWeight="600",y.style.color="#555",y.style.width="140px",y.style.flexShrink="0";const i=document.createElement("input"),G=a==="color"||a==="backgroundColor"||a==="fill"||a==="stroke";i.type=G?"color":"text";const H=a.replace(/([A-Z])/g,"-$1").toLowerCase();let P=Q.getPropertyValue(H);const L=r.style.getPropertyValue(H);if(L&&(P=L),G&&P){const K=P.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(K){const oe=parseInt(K[1]),pe=parseInt(K[2]),Xe=parseInt(K[3]);P="#"+[oe,pe,Xe].map(pt=>{const Be=pt.toString(16);return Be.length===1?"0"+Be:Be}).join("")}else P!=="transparent"&&!P.startsWith("#")&&(["transparent","inherit","initial"].includes(P.toLowerCase())||(P={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",yellow:"#ffff00",cyan:"#00ffff",magenta:"#ff00ff",gray:"#808080",grey:"#808080"}[P.toLowerCase()]||P))}i.value=P,i.dataset.originalValue=P;const W={animationDuration:{placeholder:"10s, 5s, 2s",title:"Tipo: Tempo | Valores: Xs (segundos), Xms (milissegundos) | Ex: 5s (5 segundos), 500ms (meio segundo)"},animationTimingFunction:{placeholder:"linear, ease, ease-in-out",title:"Tipo: Fun√ß√£o | Valores: linear, ease, ease-in, ease-out, ease-in-out, cubic-bezier()"},animationIterationCount:{placeholder:"infinite, 3, 5",title:"Tipo: N√∫mero ou Palavra | Valores: infinite (infinito), 1, 2, 3, etc"},fontSize:{placeholder:"16px, 1.5rem, 2em",title:"Tipo: Tamanho | Valores: Xpx, Xrem, Xem, X% | Ex: 16px, 1.5rem, 120%"},fontWeight:{placeholder:"400, 700, bold",title:"Tipo: Peso | Valores: 100-900 (incrementos de 100), normal, bold, bolder, lighter"},fontFamily:{placeholder:"Arial, sans-serif",title:'Tipo: Nome da Fonte | Valores: "Nome da Fonte", fam√≠lia gen√©rica | Ex: "Arial", sans-serif'},lineHeight:{placeholder:"1.5, 24px",title:"Tipo: N√∫mero ou Tamanho | Valores: n√∫mero (multiplicador), Xpx, Xrem | Ex: 1.5, 24px"},strokeWidth:{placeholder:"2, 3, 5",title:"Tipo: N√∫mero | Valores: n√∫meros positivos | Ex: 1, 2, 3, 5"},opacity:{placeholder:"0.5, 0.8, 1",title:"Tipo: N√∫mero | Valores: 0 (transparente) a 1 (opaco) | Ex: 0.5 (50%), 0.8 (80%)"},filter:{placeholder:"blur(5px), brightness(1.2)",title:"Tipo: Fun√ß√£o | Valores: blur(Xpx), brightness(X), contrast(X), grayscale(X), etc"},fill:{placeholder:"#CFAF5A",title:"Tipo: Cor | Valores: #hex, rgb(), rgba(), nome | Ex: #ff0000, rgb(255,0,0), red"},stroke:{placeholder:"#000000",title:"Tipo: Cor | Valores: #hex, rgb(), rgba(), nome | Ex: #ff0000, rgb(255,0,0), black"},color:{placeholder:"#000000",title:"Tipo: Cor | Valores: #hex, rgb(), rgba(), nome | Ex: #333333, rgb(51,51,51), black"},backgroundColor:{placeholder:"#ffffff",title:"Tipo: Cor | Valores: #hex, rgb(), rgba(), nome, transparent | Ex: #ffffff, white"}};W[a]&&(i.placeholder=W[a].placeholder,i.title=W[a].title),i.style.flex="1",i.style.padding="4px 8px",i.style.border="1px solid #ccc",i.style.borderRadius="4px",i.style.fontSize="11px",i.dataset.cssProp=a,b.appendChild(y),b.appendChild(i),ce.appendChild(b)});const je=document.createElement("div");je.style.display="none",je.style.gap="8px",je.style.flexDirection="column",["width","height","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderRadius"].forEach(a=>{const b=document.createElement("div");b.style.display="flex",b.style.alignItems="center",b.style.gap="8px",b.style.marginBottom="8px";const y=document.createElement("label"),_={width:"‚ÜîÔ∏è Largura",height:"‚ÜïÔ∏è Altura",marginTop:"‚¨ÜÔ∏è Margem Topo",marginRight:"‚û°Ô∏è Margem Direita",marginBottom:"‚¨áÔ∏è Margem Baixo",marginLeft:"‚¨ÖÔ∏è Margem Esquerda",paddingTop:"üì¶‚¨ÜÔ∏è Padding Topo",paddingRight:"üì¶‚û°Ô∏è Padding Direita",paddingBottom:"üì¶‚¨áÔ∏è Padding Baixo",paddingLeft:"üì¶‚¨ÖÔ∏è Padding Esquerda",borderRadius:"‚≠ï Arredondamento"};y.textContent=_[a]||a,y.style.fontSize="11px",y.style.fontWeight="600",y.style.color="#555",y.style.width="120px",y.style.flexShrink="0";const i=document.createElement("input");i.type="text";const G=Q.getPropertyValue(a.replace(/([A-Z])/g,"-$1").toLowerCase());i.value=G,i.dataset.originalValue=G;const H={width:{placeholder:"100px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, Xem, auto | Ex: 200px, 50%, auto"},height:{placeholder:"100px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, Xem, auto | Ex: 100px, 50%, auto"},marginTop:{placeholder:"10px, 1rem, auto",title:"Tipo: Tamanho | Valores: Xpx, Xrem, auto, negativo | Ex: 10px, -5px, auto"},marginBottom:{placeholder:"10px, 1rem, auto",title:"Tipo: Tamanho | Valores: Xpx, Xrem, auto, negativo | Ex: 10px, -5px, auto"},marginLeft:{placeholder:"10px, 1rem, auto",title:"Tipo: Tamanho | Valores: Xpx, Xrem, auto, negativo | Ex: 10px, -5px, auto"},marginRight:{placeholder:"10px, 1rem, auto",title:"Tipo: Tamanho | Valores: Xpx, Xrem, auto, negativo | Ex: 10px, -5px, auto"},paddingTop:{placeholder:"10px, 1rem",title:"Tipo: Tamanho | Valores: Xpx, Xrem, X% | Ex: 10px, 1rem, 5%"},paddingBottom:{placeholder:"10px, 1rem",title:"Tipo: Tamanho | Valores: Xpx, Xrem, X% | Ex: 10px, 1rem, 5%"},paddingLeft:{placeholder:"10px, 1rem",title:"Tipo: Tamanho | Valores: Xpx, Xrem, X% | Ex: 10px, 1rem, 5%"},paddingRight:{placeholder:"10px, 1rem",title:"Tipo: Tamanho | Valores: Xpx, Xrem, X% | Ex: 10px, 1rem, 5%"},borderRadius:{placeholder:"5px, 50%",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem | Ex: 5px (arredondado), 50% (c√≠rculo)"}};i.placeholder=H[a]?.placeholder||"ex: 100px, 50%, auto",i.title=H[a]?.title||"",i.style.flex="1",i.style.padding="4px 8px",i.style.border="1px solid #ccc",i.style.borderRadius="4px",i.style.fontSize="11px",i.dataset.cssProp=a,b.appendChild(y),b.appendChild(i),je.appendChild(b)});const Ne=document.createElement("div");Ne.style.display="none",Ne.style.gap="8px",Ne.style.flexDirection="column",["display","position","top","left","right","bottom","zIndex","flexDirection","justifyContent","alignItems","gap","gridTemplateColumns","gridTemplateRows","transform","transition"].forEach(a=>{const b=document.createElement("div");b.style.display="flex",b.style.alignItems="center",b.style.gap="8px",b.style.marginBottom="8px";const y=document.createElement("label"),_={display:"üëÅÔ∏è Display",position:"üìç Posi√ß√£o",top:"‚¨ÜÔ∏è Topo",left:"‚¨ÖÔ∏è Esquerda",right:"‚û°Ô∏è Direita",bottom:"‚¨áÔ∏è Baixo",zIndex:"üîù Z-Index",flexDirection:"üîÄ Flex Dire√ß√£o",justifyContent:"‚ÜîÔ∏è Justify",alignItems:"‚ÜïÔ∏è Align",gap:"üìè Espa√ßo Flex",gridTemplateColumns:"üìä Grid Colunas",gridTemplateRows:"üìä Grid Linhas",transform:"üîÑ Transform",transition:"‚ö° Transi√ß√£o"};y.textContent=_[a]||a,y.style.fontSize="11px",y.style.fontWeight="600",y.style.color="#555",y.style.width="130px",y.style.flexShrink="0";const i=document.createElement("input");i.type="text";const G=Q.getPropertyValue(a.replace(/([A-Z])/g,"-$1").toLowerCase());i.value=G,i.dataset.originalValue=G;const H={display:{placeholder:"block, flex, grid, none",title:"Tipo: Enum | Valores: none, block, inline, inline-block, flex, grid, table, inline-flex | Ex: flex, block"},position:{placeholder:"relative, absolute, fixed",title:"Tipo: Enum | Valores: static, relative, absolute, fixed, sticky | Ex: relative, absolute"},top:{placeholder:"10px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, auto, negativo | Ex: 10px, 50%, -20px"},left:{placeholder:"10px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, auto, negativo | Ex: 10px, 50%, -20px"},right:{placeholder:"10px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, auto, negativo | Ex: 10px, 50%, -20px"},bottom:{placeholder:"10px, 50%, auto",title:"Tipo: Tamanho | Valores: Xpx, X%, Xrem, auto, negativo | Ex: 10px, 50%, -20px"},zIndex:{placeholder:"10, 100, 999",title:"Tipo: N√∫mero | Valores: n√∫meros inteiros (negativo a positivo) | Ex: 1, 10, 100, -1"},transform:{placeholder:"rotate(45deg), scale(1.2)",title:"Tipo: Fun√ß√£o | Valores: rotate(Xdeg), scale(X), translate(Xpx, Ypx), skew(Xdeg) | Ex: rotate(45deg) scale(1.2)"},transition:{placeholder:"all 0.3s ease",title:"Tipo: Transi√ß√£o | Formato: [propriedade] [dura√ß√£o] [timing] [delay] | Ex: all 0.3s ease, opacity 500ms"},flexDirection:{placeholder:"row, column",title:"Tipo: Enum | Valores: row, column, row-reverse, column-reverse | Ex: row, column"},justifyContent:{placeholder:"center, space-between",title:"Tipo: Enum | Valores: flex-start, center, flex-end, space-between, space-around, space-evenly | Ex: center"},alignItems:{placeholder:"center, flex-start",title:"Tipo: Enum | Valores: flex-start, center, flex-end, stretch, baseline | Ex: center, stretch"},gap:{placeholder:"10px, 1rem",title:"Tipo: Tamanho | Valores: Xpx, Xrem, X% | Ex: 10px, 1rem, 20px"},gridTemplateColumns:{placeholder:"repeat(3, 1fr)",title:"Tipo: Template | Valores: repeat(X, Xfr), Xpx Xpx, X% X% | Ex: repeat(3, 1fr), 100px 200px"},gridTemplateRows:{placeholder:"repeat(2, 1fr)",title:"Tipo: Template | Valores: repeat(X, Xfr), Xpx Xpx, auto | Ex: repeat(2, 1fr), 100px auto"}};i.placeholder=H[a]?.placeholder||"",i.title=H[a]?.title||"",i.style.flex="1",i.style.padding="4px 8px",i.style.border="1px solid #ccc",i.style.borderRadius="4px",i.style.fontSize="11px",i.dataset.cssProp=a,b.appendChild(y),b.appendChild(i),Ne.appendChild(b)}),te.appendChild(B),te.appendChild(ce),te.appendChild(je),te.appendChild(Ne);const Me=a=>{B.style.display=a==="text"?"block":"none",ce.style.display=a==="style"?"flex":"none",je.style.display=a==="layout"?"flex":"none",Ne.style.display=a==="advanced"?"flex":"none",J.style.backgroundColor=a==="text"?"#CFAF5A":"#e5e7eb",J.style.color=a==="text"?"white":"#666",I.style.backgroundColor=a==="style"?"#CFAF5A":"#e5e7eb",I.style.color=a==="style"?"white":"#666",he.style.backgroundColor=a==="layout"?"#CFAF5A":"#e5e7eb",he.style.color=a==="layout"?"white":"#666",S.style.backgroundColor=a==="advanced"?"#CFAF5A":"#e5e7eb",S.style.color=a==="advanced"?"white":"#666"};J.onclick=()=>Me("text"),I.onclick=()=>Me("style"),he.onclick=()=>Me("layout"),S.onclick=()=>Me("advanced");const Ce=document.createElement("div");Ce.style.display="flex",Ce.style.gap="8px",Ce.style.justifyContent="flex-end";const de=document.createElement("button");de.textContent="‚úì OK",de.style.padding="6px 16px",de.style.backgroundColor="#10b981",de.style.color="white",de.style.border="none",de.style.borderRadius="4px",de.style.cursor="pointer",de.style.fontWeight="600";const ue=document.createElement("button");ue.textContent="‚úï Cancelar",ue.style.padding="6px 12px",ue.style.backgroundColor="#6b7280",ue.style.color="white",ue.style.border="none",ue.style.borderRadius="4px",ue.style.cursor="pointer";const Je=()=>{const a=$.value,b={},y=x.querySelectorAll("input[data-css-prop]");console.log(`üîç Found ${y.length} input fields with data-css-prop`);let _=0;y.forEach((H,P)=>{const L=H,W=L.dataset.cssProp,K=L.dataset.originalValue||"",oe=L.value;if(W&&oe!==K){const pe=W.replace(/([A-Z])/g,"-$1").toLowerCase();console.log(`  ‚úèÔ∏è [${P}] MODIFICADO: ${W} (${pe})`),console.log(`      Original: "${K}"`),console.log(`      Novo: "${oe}"`),b[pe]=oe,_++}}),console.log(`üìù Total de propriedades modificadas: ${_} de ${y.length}`),Object.entries(b).forEach(([H,P])=>{console.log(`Applying CSS: ${H} = ${P}`),r.style.setProperty(H,P)});let i=f;f.includes("_dup_")&&(i=f.replace(/_dup_\d+$/,""),console.log(`üîÑ Removing duplicate suffix: "${f}" ‚Üí "${i}"`));const G=r.tagName.toLowerCase()==="svg";try{const H=r.textContent;if(console.log(`üìù Aplicando mudan√ßa visual: "${H}" ‚Üí "${a}"`),r.children.length===0)r.textContent=a;else{const P=Array.from(r.childNodes).filter(L=>L.nodeType===Node.TEXT_NODE);P.length>0?P[0].textContent=a:r.textContent=a}T.current.set(i,a),console.log(`üíæ Adicionado ao map local: ${i} = "${a}"`),Re(s,!0),console.log(`üîí Edit lock ativado para ${s}`),Y(P=>{const L=[...P];if(G){const W=i.startsWith("icons.")?`${i}.styles`:`${i}__styles`,K=L.findIndex(pe=>pe.key===W),oe=JSON.stringify(b);K>=0?L[K]={...L[K],currentValue:oe,isModified:!0}:L.push({key:W,originalValue:"",currentValue:oe,isModified:!0}),console.log(`üíæ Saving SVG styles to: ${W}`)}else{const W=L.findIndex(K=>K.key===i);if(W>=0&&(L[W]={...L[W],currentValue:a,isModified:L[W].originalValue!==a}),Object.keys(b).length>0){const K=`${i}__styles`,oe=L.findIndex(Xe=>Xe.key===K),pe=JSON.stringify(b);oe>=0?L[oe]={...L[oe],currentValue:pe,isModified:!0}:L.push({key:K,originalValue:"",currentValue:pe,isModified:!0}),console.log(`üíÖ Saving CSS changes for: ${i}`)}}return L}),console.log('‚úÖ Mudan√ßa aplicada no DOM e state. Use "Salvar Mudan√ßas" para persistir no DB.')}catch(H){console.error("Error in saveEdit:",H)}We()},Oe=()=>{We()},We=()=>{document.body.contains(n)&&document.body.removeChild(n),document.body.contains(x)&&document.body.removeChild(x),ne(null)};de.addEventListener("click",Je),ue.addEventListener("click",Oe),n.addEventListener("click",Oe),$.addEventListener("keydown",a=>{a.key==="Escape"?(a.preventDefault(),Oe()):a.key==="Enter"&&a.ctrlKey&&(a.preventDefault(),Je())});const we=document.createElement("div");we.textContent="Ctrl+Enter para salvar | Esc para cancelar",we.style.fontSize="10px",we.style.color="#999",we.style.marginTop="8px",we.style.textAlign="center",Ce.appendChild(de),Ce.appendChild(ue),x.appendChild(w),x.appendChild(X),x.appendChild(te),x.appendChild(Ce),x.appendChild(we),document.body.appendChild(n),document.body.appendChild(x),x.style.width=`${Math.max(c.width,500)}px`,x.style.maxWidth="90vw",$.focus(),$.select()}},M=()=>{const l=document.querySelectorAll("[data-editable]");console.log(`üé® Adding highlights to ${l.length} editable elements`),l.forEach(p=>{const d=p,N={cursor:d.style.cursor,outline:d.style.outline,transition:d.style.transition};d.setAttribute("data-original-styles",JSON.stringify(N)),d.style.cursor="pointer",d.style.outline="1px dashed rgba(207, 175, 90, 0.5)",d.style.transition="all 0.2s";const r=()=>{d.style.outline="2px solid rgba(207, 175, 90, 0.9)",d.style.backgroundColor="rgba(207, 175, 90, 0.15)",d.style.boxShadow="0 0 8px rgba(207, 175, 90, 0.3)";const n=d.getBoundingClientRect(),c=document.createElement("div");c.className="element-type-badge",c.textContent=`<${d.tagName.toLowerCase()}>`,c.style.position="fixed",c.style.top=`${n.top-20}px`,c.style.left=`${n.left}px`,c.style.backgroundColor="#CFAF5A",c.style.color="white",c.style.padding="2px 6px",c.style.fontSize="10px",c.style.fontWeight="bold",c.style.borderRadius="3px",c.style.zIndex="10000",c.style.pointerEvents="none",c.style.fontFamily="monospace",c.setAttribute("data-element-id",d.getAttribute("data-editable")||""),document.body.appendChild(c)},f=()=>{d.style.outline="1px dashed rgba(207, 175, 90, 0.5)",d.style.backgroundColor="transparent",d.style.boxShadow="none";const n=d.getAttribute("data-editable"),c=document.body.querySelector(`.element-type-badge[data-element-id="${n}"]`);c&&c.remove()};d.addEventListener("mouseenter",r),d.addEventListener("mouseleave",f)})};return document.addEventListener("click",j,!0),setTimeout(()=>{M()},100),setTimeout(()=>{M()},500),setTimeout(()=>{M()},1e3),()=>{document.removeEventListener("click",j,!0);const l=document.getElementById("visual-editor-styles");l&&l.remove();const p=document.querySelector(".visual-editor-overlay"),d=document.querySelector(".visual-editor-container");p&&document.body.contains(p)&&document.body.removeChild(p),d&&document.body.contains(d)&&document.body.removeChild(d),document.body.querySelectorAll(".element-type-badge").forEach(f=>f.remove());const r=document.querySelectorAll("[data-editable]");console.log(`üßπ Restoring original styles for ${r.length} elements...`),r.forEach(f=>{const n=f,c=n.getAttribute("data-original-styles");if(c){try{const A=JSON.parse(c);n.style.cursor=A.cursor||"",n.style.outline=A.outline||"",n.style.transition=A.transition||""}catch(A){console.warn("Failed to parse original styles:",A)}n.removeAttribute("data-original-styles")}else n.style.cursor="",n.style.outline="",n.style.transition="";n.style.backgroundColor="",n.style.boxShadow="",n.removeAttribute("data-editable")})}},[F,V,s]);const fe=async()=>{if(q.current){console.warn("‚ö†Ô∏è Save already in progress, skipping duplicate call...");return}q.current=!0;try{const E=V.filter(l=>l.isModified),u={},j={};E.forEach(l=>{l.key.endsWith("__styles")||l.key.endsWith(".styles")?j[l.key.replace(/__styles$/,"").replace(/\.styles$/,"")]=l.currentValue:u[l.key]={newText:l.currentValue}}),console.log("üìù Text edits:",Object.keys(u).length),console.log("üíÖ Style edits:",Object.keys(j).length),console.log("üì§ Enviando para API:",u),console.group("üîç DETALHES DAS EDI√á√ïES:"),Object.entries(u).forEach(([l,p])=>{console.log(`   ${l}:`,{newText:p.newText.substring(0,100),type:typeof p,hasNewText:"newText"in p})}),console.groupEnd();let M=0;if(Object.keys(u).length>0)try{const l={pageId:s,edits:u};console.log("üöÄ PAYLOAD COMPLETO:",JSON.stringify(l,null,2)),console.log("üåê URL:",Te.saveVisualEdits);const p=await fetch(Te.saveVisualEdits,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("üì® Response status:",p.status),p.ok){const d=await p.json();console.log("‚úÖ Response body:",d),M+=Object.keys(u).length}else throw new Error("API error saving texts")}catch(l){console.error("API error (texts):",l),o({type:"error",text:"‚úó Erro ao salvar textos. Servidor API n√£o est√° respondendo."}),setTimeout(()=>o(null),8e3);return}if(Object.keys(j).length>0)try{const l=Object.entries(j).map(([N,r])=>`${N} { ${r} }`).join(`
`),p={pageId:s,css:l},d=await fetch(Te.saveStyles,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(d.ok){const N=await d.json();M+=Object.keys(j).length}else throw new Error("API error saving styles")}catch(l){console.error("API error (styles):",l),o({type:"error",text:"‚úó Erro ao salvar estilos. Servidor API n√£o est√° respondendo."}),setTimeout(()=>o(null),8e3);return}o({type:"success",text:`‚úì ${M} altera√ß√µes salvas! Atualizando com dados salvos...`});try{const l=await fetch(Te.getContent(s));if(!l.ok)throw new Error("Erro ao validar dados do servidor");const d=(await l.json()).content||{};Y(r=>r.map(n=>{const c=d[n.key];return c!=null?(console.log(`‚úì Validado [${n.key}]: DB confirmou valor`),{key:n.key,originalValue:c,currentValue:c,isModified:!1}):{...n,isModified:!1}}));const N=(r,f)=>{const n=f.split(".");let c=r;for(const A of n)if(c&&typeof c=="object"&&A in c)c=c[A];else return;return c};V.forEach(r=>{const f=document.querySelector(`[data-editable="${r.key}"]`);if(!f)return;const n=N(d,r.key);if(n!=null)if(!r.key.includes("__styles")&&!r.key.includes(".styles")){const c=String(n);f.textContent!==c&&(console.log(`üîÑ Sincronizando DOM [${r.key}]: "${f.textContent}" ‚Üí "${c}"`),f.textContent=c)}else try{const c=typeof n=="string"?JSON.parse(n):n;Object.entries(c).forEach(([A,O])=>{f.style.setProperty(A,O)}),console.log(`üé® Sincronizando estilos [${r.key}]`)}catch(c){console.error("Erro ao aplicar estilos validados:",c)}}),T.current.clear(),console.log("üßπ Map de edi√ß√µes locais limpo"),Re(s,!1),console.log("üîì Edit lock desativado"),o({type:"success",text:`‚úì ${M} altera√ß√µes salvas! Sincronizando...`}),console.log(`üîÑ Triggering refresh for page: ${s}`),jt(s),setTimeout(()=>{Y(r=>r.map(f=>({...f,originalValue:f.currentValue,isModified:!1}))),o(null),U(!1),console.log("‚úÖ Estado sincronizado com Supabase e modo de edi√ß√£o desativado")},1e3)}catch(l){console.error("‚ùå Erro na valida√ß√£o em malha fechada:",l),o({type:"error",text:"‚ö†Ô∏è Dados salvos, mas falha na valida√ß√£o. Recarregue a p√°gina para confirmar."}),setTimeout(()=>o(null),5e3)}}catch(E){console.error("=== ERROR SAVING ==="),console.error("Error details:",E),o({type:"error",text:`‚úó Erro ao salvar: ${E}`}),setTimeout(()=>o(null),8e3)}finally{q.current=!1,console.log("üîì Save lock released")}},Ae=()=>{D?le(!0):me()},me=()=>{const E=document.querySelector(".fixed.inset-0.bg-black\\/80.z-\\[9999\\]");E&&E.remove(),T.current.clear(),console.log("üßπ Map de edi√ß√µes locais limpo (cancelamento)"),console.log(`üì¶ Total de fields dispon√≠veis: ${V.length}`);let u=0,j=0;const M=V.filter(p=>!p.key.includes("__styles")&&!p.key.includes(".styles")),l=V.filter(p=>p.key.includes("__styles")||p.key.includes(".styles"));console.log(`üìÑ Campos de texto: ${M.length}`),console.log(`üé® Campos de estilo: ${l.length}`),M.forEach(p=>{const d=document.querySelectorAll("*");for(const N of Array.from(d)){const r=N;if(r.getAttribute("data-editable")===p.key&&r.textContent!==p.originalValue){console.log(`‚Ü©Ô∏è Restaurando texto [${p.key}]: "${r.textContent?.substring(0,30)}" ‚Üí "${p.originalValue?.substring(0,30)}"`),r.textContent=p.originalValue,u++;break}}}),l.forEach(p=>{const d=p.key.replace(/\.styles$/,"").replace(/__styles$/,"");if(console.log(`üîç Procurando elemento com key: ${d} (de ${p.key})`),!p.originalValue||p.originalValue===""){console.log("   ‚ö†Ô∏è Sem estilos originais (campo criado durante edi√ß√£o) - removendo estilos aplicados");const f=document.querySelectorAll("*");for(const n of Array.from(f)){const c=n;if(c.getAttribute("data-editable")===d){try{const O=JSON.parse(p.currentValue);Object.keys(O).forEach(x=>{console.log(`   ‚Üí Removendo: ${x}`),c.style.removeProperty(x)}),j++}catch(O){console.error("‚ùå Erro ao remover estilos:",O)}break}}return}const N=document.querySelectorAll("*");let r=!1;for(const f of Array.from(N)){const n=f;if(n.getAttribute("data-editable")===d){r=!0,console.log(`‚úì Elemento encontrado! Tag: ${n.tagName}`);try{const A=JSON.parse(p.originalValue);console.log(`üé® Restaurando estilos [${d}]:`,A),Object.entries(A).forEach(([O,x])=>{console.log(`   ‚Üí Aplicando: ${O} = ${x}`),n.style.setProperty(O,x)}),j++;break}catch(A){console.error("‚ùå Erro ao parsear/aplicar estilos:",A),console.error("   Field:",p)}}}r||console.warn(`‚ö†Ô∏è Elemento n√£o encontrado para: ${d}`)}),console.log(`‚úÖ Restaurados ${u} textos e ${j} estilos no DOM`),Y(p=>p.map(N=>({...N,currentValue:N.originalValue,isModified:!1}))),U(!1),ne(null)};return e.jsxs("div",{className:"space-y-4",children:[ye&&e.jsx("div",{className:"fixed top-4 right-4 z-10000 toast-notification",children:e.jsx(Le,{className:`${ye.type==="success"?"bg-green-500 border-green-600 text-white shadow-2xl":"bg-red-500 border-red-600 text-white shadow-2xl"} min-w-[400px] max-w-[600px]`,children:e.jsx(Fe,{className:"text-white font-semibold text-base flex items-center gap-2",children:ye.text})})}),e.jsx("div",{className:"fixed bottom-6 right-6 z-50 flex flex-col gap-3",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),fe()},disabled:!D,className:`flex items-center justify-center gap-2 px-6 py-3 font-semibold rounded-full shadow-lg hover:shadow-2xl transition-all duration-300 hover:scale-105 ${D?"bg-green-600 hover:bg-green-700 text-white cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:"Salvar Mudan√ßas",children:[e.jsx(ct,{className:"w-5 h-5"}),e.jsx("span",{children:"Salvar"}),D&&e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"})]}),e.jsxs("button",{onClick:Ae,className:"flex items-center justify-center gap-2 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-full shadow-lg hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Cancelar",children:[e.jsx(lt,{className:"w-5 h-5"}),e.jsx("span",{children:"Cancelar"})]})]}):e.jsxs("button",{onClick:()=>{U(!0)},className:"flex items-center justify-center gap-2 px-6 py-3 bg-[#CFAF5A] hover:bg-[#B38938] text-white font-semibold rounded-full shadow-lg hover:shadow-2xl transition-all duration-300 hover:scale-105 animate-float",title:"Ativar Edi√ß√£o",children:[e.jsx(Rs,{className:"w-5 h-5"}),e.jsx("span",{children:"Ativar Edi√ß√£o"})]})}),z&&e.jsx("div",{className:"fixed inset-0 z-10000 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"shrink-0 w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Descartar Altera√ß√µes?"}),e.jsxs("p",{className:"text-gray-600 text-sm leading-relaxed",children:["Voc√™ tem ",e.jsxs("strong",{className:"text-orange-600",children:[V.filter(E=>E.isModified).length," altera√ß√£o(√µes)"]})," n√£o salvas que ser√£o perdidas permanentemente."]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>le(!1),className:"px-6 py-2.5 rounded-lg font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 transition-colors duration-200",children:"Continuar Editando"}),e.jsx("button",{onClick:()=>{le(!1),me()},className:"px-6 py-2.5 rounded-lg font-semibold text-white bg-red-600 hover:bg-red-700 transition-colors duration-200 shadow-lg hover:shadow-xl",children:"Descartar Altera√ß√µes"})]})]})}),D&&F&&e.jsx("div",{className:"fixed top-4 left-4 z-9999",children:e.jsx("div",{className:"bg-orange-500 text-white px-4 py-2 rounded-full shadow-lg font-semibold text-sm animate-pulse",children:"‚ö†Ô∏è Altera√ß√µes n√£o salvas"})}),F&&e.jsx("div",{className:"fixed top-20 right-4 z-9999 max-w-xs",children:e.jsx(Le,{className:"bg-blue-50 border-blue-300 shadow-lg",children:e.jsxs(Fe,{className:"text-blue-900 text-xs",children:[e.jsx("strong",{children:"Modo Ativo:"})," Clique em textos destacados para editar.",e.jsxs("div",{className:"mt-1",children:[e.jsx("kbd",{className:"px-1 py-0.5 bg-white rounded border text-[10px]",children:"Ctrl+Enter"})," salvar |",e.jsx("kbd",{className:"px-1 py-0.5 bg-white rounded border text-[10px] ml-1",children:"Esc"})," cancelar"]})]})})}),e.jsx("div",{className:F?"border-4 border-dashed border-amber-400 rounded-lg":"",children:e.jsx(g,{})})]})}const Se=h.forwardRef(({className:g,type:C,...s},F)=>e.jsx("input",{type:C,className:ee("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",g),ref:F,...s}));Se.displayName="Input";const io=Nt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ae=h.forwardRef(({className:g,...C},s)=>e.jsx(Qe,{ref:s,className:ee(io(),g),...C}));ae.displayName=Qe.displayName;function co({content:g,onChange:C}){const s=Bt({extensions:[Gt.configure({heading:{levels:[1,2,3]}}),Ht,qt.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline"}}),Jt.configure({HTMLAttributes:{class:"max-w-full h-auto rounded"}}),Wt.configure({types:["heading","paragraph"]}),Kt.configure({multicolor:!0}),Ut,Yt],content:g,editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none min-h-[400px] max-w-none p-4"}},onUpdate:({editor:V})=>{C(V.getHTML())}},[]);if(h.useEffect(()=>{s&&g!==s.getHTML()&&s.commands.setContent(g)},[g,s]),!s)return null;const F=()=>{const V=window.prompt("URL do link:");V&&s.chain().focus().setLink({href:V}).run()},U=()=>{const V=window.prompt("URL da imagem:");V&&s.chain().focus().setImage({src:V}).run()};return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 border-b p-2 flex flex-wrap gap-1",children:[e.jsxs("div",{className:"flex gap-1 border-r pr-2",children:[e.jsx(R,{type:"button",size:"sm",variant:s.isActive("bold")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleBold().run(),title:"Negrito",children:e.jsx(es,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("italic")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleItalic().run(),title:"It√°lico",children:e.jsx(Ss,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("underline")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleUnderline().run(),title:"Sublinhado",children:e.jsx(so,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("highlight")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleHighlight().run(),title:"Destacar",children:e.jsx(Cs,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1 border-r pr-2",children:[e.jsx(R,{type:"button",size:"sm",variant:s.isActive("heading",{level:1})?"secondary":"ghost",onClick:()=>s.chain().focus().toggleHeading({level:1}).run(),title:"T√≠tulo 1",children:e.jsx(ys,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("heading",{level:2})?"secondary":"ghost",onClick:()=>s.chain().focus().toggleHeading({level:2}).run(),title:"T√≠tulo 2",children:e.jsx(bs,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("heading",{level:3})?"secondary":"ghost",onClick:()=>s.chain().focus().toggleHeading({level:3}).run(),title:"T√≠tulo 3",children:e.jsx(js,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1 border-r pr-2",children:[e.jsx(R,{type:"button",size:"sm",variant:s.isActive("bulletList")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleBulletList().run(),title:"Lista",children:e.jsx(_s,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("orderedList")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleOrderedList().run(),title:"Lista Numerada",children:e.jsx($s,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("blockquote")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleBlockquote().run(),title:"Cita√ß√£o",children:e.jsx(Ct,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive("code")?"secondary":"ghost",onClick:()=>s.chain().focus().toggleCode().run(),title:"C√≥digo",children:e.jsx(ds,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1 border-r pr-2",children:[e.jsx(R,{type:"button",size:"sm",variant:s.isActive({textAlign:"left"})?"secondary":"ghost",onClick:()=>s.chain().focus().setTextAlign("left").run(),title:"Alinhar √† Esquerda",children:e.jsx(Qs,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive({textAlign:"center"})?"secondary":"ghost",onClick:()=>s.chain().focus().setTextAlign("center").run(),title:"Centralizar",children:e.jsx(Ws,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:s.isActive({textAlign:"right"})?"secondary":"ghost",onClick:()=>s.chain().focus().setTextAlign("right").run(),title:"Alinhar √† Direita",children:e.jsx(Us,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1 border-r pr-2",children:[e.jsx(R,{type:"button",size:"sm",variant:"ghost",onClick:F,title:"Adicionar Link",children:e.jsx(As,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:"ghost",onClick:U,title:"Adicionar Imagem",children:e.jsx(ks,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{type:"button",size:"sm",variant:"ghost",onClick:()=>s.chain().focus().undo().run(),disabled:!s.can().undo(),title:"Desfazer",children:e.jsx(ao,{className:"w-4 h-4"})}),e.jsx(R,{type:"button",size:"sm",variant:"ghost",onClick:()=>s.chain().focus().redo().run(),disabled:!s.can().redo(),title:"Refazer",children:e.jsx(Ls,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"bg-white",children:e.jsx(Qt,{editor:s})})]})}const De=ht,Pe=gt,$e=h.forwardRef(({className:g,children:C,...s},F)=>e.jsxs(Ze,{ref:F,className:ee("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",g),...s,children:[C,e.jsx(xt,{asChild:!0,children:e.jsx(rt,{className:"h-4 w-4 opacity-50"})})]}));$e.displayName=Ze.displayName;const dt=h.forwardRef(({className:g,...C},s)=>e.jsx(st,{ref:s,className:ee("flex cursor-default items-center justify-center py-1",g),...C,children:e.jsx(as,{className:"h-4 w-4"})}));dt.displayName=st.displayName;const ut=h.forwardRef(({className:g,...C},s)=>e.jsx(ot,{ref:s,className:ee("flex cursor-default items-center justify-center py-1",g),...C,children:e.jsx(rt,{className:"h-4 w-4"})}));ut.displayName=ot.displayName;const Ve=h.forwardRef(({className:g,children:C,position:s="popper",...F},U)=>e.jsx(yt,{children:e.jsxs(et,{ref:U,className:ee("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",g),position:s,...F,children:[e.jsx(dt,{}),e.jsx(ft,{className:ee("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:C}),e.jsx(ut,{})]})}));Ve.displayName=et.displayName;const uo=h.forwardRef(({className:g,...C},s)=>e.jsx(at,{ref:s,className:ee("px-2 py-1.5 text-sm font-semibold",g),...C}));uo.displayName=at.displayName;const xe=h.forwardRef(({className:g,children:C,...s},F)=>e.jsxs(tt,{ref:F,className:ee("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",g),...s,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(bt,{children:e.jsx(ss,{className:"h-4 w-4"})})}),e.jsx(vt,{children:C})]}));xe.displayName=tt.displayName;const po=h.forwardRef(({className:g,...C},s)=>e.jsx(nt,{ref:s,className:ee("-mx-1 my-1 h-px bg-muted",g),...C}));po.displayName=nt.displayName;const ge={ADMIN_TAB:"adminConsole_activeTab",DRAFT_PREFIX:"blogEditor_draft_"};function mo(){const[g,C]=h.useState([]),[s,F]=h.useState(!0),[U,V]=h.useState(""),[Y,_e]=h.useState("all"),[ne,ye]=h.useState("all"),[o,z]=h.useState(null),[le,q]=h.useState(null),[T,D]=h.useState("VIEWING"),[fe,Ae]=h.useState(null),me=h.useRef(!1);h.useRef(null);const E=h.useRef(!1),u=T==="EDITING"||T==="CREATING",j=["Desenvolvimento Espiritual","Cura Interior","Medita√ß√£o e Pr√°ticas","Conhecimento Esot√©rico"],M=["Igreja Metatron","Instituto Metatron"],l=(t,m)=>{Ae({type:t,text:m}),setTimeout(()=>Ae(null),5e3)},p=async()=>{try{F(!0);const{data:t,error:m}=await He.from("blog_posts").select("*").order("created_at",{ascending:!1});if(m)throw m;C(t||[])}catch(t){console.error("Erro ao carregar posts:",t),l("error","Erro ao carregar posts")}finally{F(!1)}};h.useEffect(()=>{if(p(),localStorage.getItem(ge.ADMIN_TAB)==="blog"){console.log("üìÇ Verificando rascunhos salvos...");const m=Object.keys(localStorage).filter(v=>v.startsWith(ge.DRAFT_PREFIX));if(m.length>0){const v=m.map(w=>({key:w,data:JSON.parse(localStorage.getItem(w)||"{}")})).filter(w=>w.data.post);if(v.length>0){v.sort((X,re)=>(re.data.timestamp||0)-(X.data.timestamp||0));const w=v[0].data;console.log("‚úÖ Rascunho encontrado:",w.post.title),console.log("‚è∞ Salvo em:",new Date(w.timestamp).toLocaleString()),E.current=!0,z(w.post),q(w.original),D(w.post.id?"EDITING":"CREATING"),l("success",`üìù Rascunho restaurado: "${w.post.title}"`)}}else console.log("‚ÑπÔ∏è Nenhum rascunho encontrado")}},[]),h.useEffect(()=>{if(E.current){E.current=!1;return}if(!o||!le){D("VIEWING");return}JSON.stringify(o)!==JSON.stringify(le)?(D(o.id?"EDITING":"CREATING"),d(o,le)):(D("VIEWING"),N(o.id))},[o,le]);const d=(t,m)=>{const v=`${ge.DRAFT_PREFIX}${t.id||"new"}`;localStorage.setItem(v,JSON.stringify({post:t,original:m,timestamp:Date.now()})),localStorage.setItem(ge.ADMIN_TAB,"blog")},N=t=>{const m=`${ge.DRAFT_PREFIX}${t||"new"}`;localStorage.removeItem(m)},r=()=>{Object.keys(localStorage).filter(t=>t.startsWith(ge.DRAFT_PREFIX)).forEach(t=>localStorage.removeItem(t))},f=()=>{if((T==="EDITING"||T==="CREATING")&&!confirm("Descartar altera√ß√µes n√£o salvas?"))return;const t={id:"",title:"",slug:"",excerpt:"",content:"",author:"Igreja Metatron",category:"Desenvolvimento Espiritual",tags:[],cover_image:"",published:!1,published_at:new Date().toISOString(),created_at:new Date().toISOString(),views:0};z(t),q(JSON.parse(JSON.stringify(t))),D("CREATING")},n=t=>{(T==="EDITING"||T==="CREATING")&&!confirm("Descartar altera√ß√µes n√£o salvas?")||(z(t),q(JSON.parse(JSON.stringify(t))),D("VIEWING"),localStorage.setItem(ge.ADMIN_TAB,"blog"))},c=()=>{if(o){if(E.current=!0,T==="CREATING"){N(""),z(null),q(null),D("VIEWING");return}if(T==="EDITING"){const t=JSON.parse(JSON.stringify(le));z(t),N(o.id),D("VIEWING"),l("success","Altera√ß√µes descartadas");return}r(),z(null),q(null),D("VIEWING")}},A=async t=>{if(confirm("Tem certeza que deseja excluir este artigo?"))try{const{error:m}=await He.from("blog_posts").delete().eq("id",t);if(m)throw m;l("success","Artigo exclu√≠do com sucesso!"),p()}catch(m){console.error("Erro ao excluir post:",m),l("error","Erro ao excluir artigo")}},O=async()=>{if(o&&T!=="SAVING"){if(D("SAVING"),me.current=!0,!o.title.trim()){l("error","T√≠tulo √© obrigat√≥rio"),D(o.id?"EDITING":"CREATING"),me.current=!1;return}o.slug.trim()||(o.slug=o.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""));try{if(o.id){const t={title:o.title,slug:o.slug,excerpt:o.excerpt,content:o.content,author:o.author,category:o.category,tags:o.tags,cover_image:o.cover_image,published:o.published,published_at:o.published?new Date().toISOString():o.published_at},m=await fetch(Te.updateBlogPost(o.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!m.ok){const w=await m.json();throw new Error(w.message||"Erro ao salvar")}E.current=!0;const v=JSON.parse(JSON.stringify(o));z(v),q(v),N(o.id),D("VIEWING"),l("success","‚úì Artigo atualizado com sucesso!"),p()}else{const{data:t,error:m}=await He.from("blog_posts").insert({title:o.title,slug:o.slug,excerpt:o.excerpt,content:o.content,author:o.author,category:o.category,tags:o.tags,cover_image:o.cover_image,published:o.published,published_at:o.published?new Date().toISOString():null}).select().single();if(m)throw m;if(E.current=!0,t){const v={...o,id:t.id};z(v),q(JSON.parse(JSON.stringify(v))),N(""),D("VIEWING")}l("success","‚úì Artigo criado com sucesso!"),p()}}catch(t){console.error("Erro ao salvar post:",t),l("error","‚úó Erro ao salvar artigo"),D(o.id?"EDITING":"CREATING")}finally{setTimeout(()=>{me.current=!1},1e3)}}},x=g.filter(t=>{const m=t.title.toLowerCase().includes(U.toLowerCase())||t.excerpt.toLowerCase().includes(U.toLowerCase()),v=Y==="all"||t.category===Y,w=ne==="all"||ne==="published"&&t.published||ne==="draft"&&!t.published;return m&&v&&w}),Q=t=>new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"});return e.jsxs("div",{className:"space-y-6",children:[fe&&e.jsx("div",{className:"fixed top-4 right-4 z-10000 animate-in slide-in-from-top duration-500",children:e.jsx(Le,{className:`${fe.type==="success"?"bg-green-500 border-green-600 text-white shadow-2xl":"bg-red-500 border-red-600 text-white shadow-2xl"} min-w-[400px] max-w-[600px]`,children:e.jsxs(Fe,{className:"text-white font-semibold text-base flex items-center gap-2",children:[fe.type==="success"?e.jsx(is,{className:"h-5 w-5"}):e.jsx(ls,{className:"h-5 w-5"}),fe.text]})})}),o&&e.jsxs("div",{className:"fixed bottom-6 right-6 z-50 flex flex-col gap-3",children:[(T==="EDITING"||T==="CREATING"||T==="SAVING")&&e.jsxs("button",{onClick:O,disabled:T==="SAVING",className:`flex items-center justify-center gap-2 px-6 py-3 font-semibold rounded-full shadow-lg hover:shadow-2xl transition-all duration-300 ${T==="SAVING"?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white cursor-pointer hover:scale-105"}`,title:T==="SAVING"?"Salvando...":T==="CREATING"?"Criar Artigo":"Salvar Mudan√ßas",children:[e.jsx(ct,{className:"w-5 h-5"}),e.jsx("span",{children:T==="SAVING"?"Salvando...":T==="CREATING"?"Criar":"Salvar"}),T!=="SAVING"&&e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"})]}),e.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-full shadow-lg hover:shadow-2xl transition-all duration-300 hover:scale-105",title:T==="VIEWING"?"Voltar para Lista":"Cancelar Edi√ß√£o",children:[e.jsx(lt,{className:"w-5 h-5"}),e.jsx("span",{children:T==="VIEWING"?"Voltar":"Cancelar"})]})]}),u&&o&&e.jsx("div",{className:"fixed top-4 left-4 z-9999",children:e.jsx("div",{className:"bg-orange-500 text-white px-4 py-2 rounded-full shadow-lg font-semibold text-sm animate-pulse",children:"‚ö†Ô∏è Altera√ß√µes n√£o salvas"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Editor de Blog"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Gerencie os artigos da Igreja e do Instituto"}),!o&&(()=>{const t=Object.keys(localStorage).filter(m=>m.startsWith(ge.DRAFT_PREFIX));if(t.length>0){const m=t.map(v=>({key:v,data:JSON.parse(localStorage.getItem(v)||"{}")})).filter(v=>v.data.post);if(m.length>0){m.sort((w,X)=>(X.data.timestamp||0)-(w.data.timestamp||0));const v=m[0].data;return e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"text-orange-600 font-semibold",children:['üíæ Rascunho dispon√≠vel: "',v.post.title,'"']}),e.jsx("button",{onClick:()=>{E.current=!0,z(v.post),q(v.original),D(v.post.id?"EDITING":"CREATING"),l("success","Rascunho restaurado")},className:"text-blue-600 hover:underline font-medium",children:"Restaurar"}),e.jsx("button",{onClick:()=>{confirm("Descartar este rascunho?")&&(r(),l("success","Rascunho descartado"),window.location.reload())},className:"text-red-600 hover:underline font-medium",children:"Descartar"})]})}}return null})()]}),e.jsxs(R,{onClick:f,className:"bg-[#CFAF5A] hover:bg-[#B89B4A]",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Novo Artigo"]})]}),e.jsx(ke,{children:e.jsx(Ee,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(ae,{children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(Se,{placeholder:"Buscar por t√≠tulo ou conte√∫do...",value:U,onChange:t=>V(t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Categoria"}),e.jsxs(De,{value:Y,onValueChange:_e,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Ve,{children:[e.jsx(xe,{value:"all",children:"Todas as categorias"}),j.map(t=>e.jsx(xe,{value:t,children:t},t))]})]})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Status"}),e.jsxs(De,{value:ne,onValueChange:ye,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Ve,{children:[e.jsx(xe,{value:"all",children:"Todos"}),e.jsx(xe,{value:"published",children:"Publicados"}),e.jsx(xe,{value:"draft",children:"Rascunhos"})]})]})]})]})})}),!o&&s?e.jsx(ke,{children:e.jsx(Ee,{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Carregando artigos..."})})}):!o&&x.length===0?e.jsx(ke,{children:e.jsxs(Ee,{className:"py-12 text-center",children:[e.jsx(wt,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum artigo encontrado"})]})}):o?null:e.jsx("div",{className:"grid grid-cols-1 gap-4",children:x.map(t=>e.jsx(ke,{children:e.jsx(Ee,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ge,{variant:t.published?"default":"secondary",children:t.published?"Publicado":"Rascunho"}),e.jsx(Ge,{variant:"outline",children:t.category}),e.jsx(Ge,{variant:"outline",children:t.author})]}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:t.excerpt}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(kt,{className:"h-4 w-4"}),Q(t.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(it,{className:"h-4 w-4"}),t.views," visualiza√ß√µes"]}),t.tags.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qs,{className:"h-4 w-4"}),t.tags.length," tags"]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>n(t),children:e.jsx(Gs,{className:"h-4 w-4"})}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>A(t.id),children:e.jsx(eo,{className:"h-4 w-4 text-red-500"})})]})]})})},t.id))}),o&&e.jsxs(ke,{children:[e.jsxs(Et,{children:[e.jsx(St,{children:o?.id?"Editar Artigo":"Novo Artigo"}),e.jsxs(Tt,{children:["Preencha os campos abaixo para ",o?.id?"atualizar":"criar"," o artigo"]})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ae,{children:"T√≠tulo *"}),e.jsx(Se,{value:o.title||"",onChange:t=>z({...o,title:t.target.value}),placeholder:"T√≠tulo do artigo"})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Slug (URL)"}),e.jsx(Se,{value:o.slug||"",onChange:t=>z({...o,slug:t.target.value}),placeholder:"url-do-artigo"})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Resumo"}),e.jsx(qe,{value:o.excerpt||"",onChange:t=>z({...o,excerpt:t.target.value}),placeholder:"Breve descri√ß√£o do artigo",rows:3})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Conte√∫do do Artigo"}),e.jsx(co,{content:o.content,onChange:t=>{z(m=>m&&{...m,content:t})}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ae,{children:"Autor"}),e.jsxs(De,{value:o.author,onValueChange:t=>z({...o,author:t}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ve,{children:M.map(t=>e.jsx(xe,{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Categoria"}),e.jsxs(De,{value:o.category,onValueChange:t=>z({...o,category:t}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ve,{children:j.map(t=>e.jsx(xe,{value:t,children:t},t))})]})]})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"Tags (separadas por v√≠rgula)"}),e.jsx(Se,{value:o.tags.join(", "),onChange:t=>z({...o,tags:t.target.value.split(",").map(m=>m.trim()).filter(m=>m)}),placeholder:"tag1, tag2, tag3"})]}),e.jsxs("div",{children:[e.jsx(ae,{children:"URL da Imagem de Capa"}),e.jsx(Se,{value:o.cover_image||"",onChange:t=>z({...o,cover_image:t.target.value}),placeholder:"https://..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"published",checked:o.published,onChange:t=>z({...o,published:t.target.checked}),className:"w-4 h-4","aria-label":"Publicar artigo"}),e.jsx(ae,{htmlFor:"published",children:"Publicar artigo"})]}),e.jsx("div",{className:"text-sm text-gray-500 italic pt-2 border-t",children:"üí° Use os bot√µes flutuantes no canto inferior direito para salvar ou cancelar"})]})})]})]})}function jo(){const g=[{id:"index",name:"Homepage",file:"Index.json",content:It,component:At},{id:"quemsomos",name:"Quem Somos",file:"QuemSomos.json",content:Vt,component:$t},{id:"contato",name:"Contato",file:"Contato.json",content:Mt,component:_t},{id:"purificacao",name:"Purifica√ß√£o",file:"Purificacao.json",content:zt,component:Rt},{id:"artigos",name:"Artigos",file:"Artigos.json",content:Pt,component:Dt},{id:"testemunhos",name:"Testemunhos",file:"Testemunhos.json",content:Ft,component:Lt},{id:"tratamentos",name:"Tratamentos",file:"Tratamentos.json",content:Xt,component:Ot}],C={};g.forEach(u=>{C[u.id]=JSON.stringify(u.content,null,2)});const[s,F]=h.useState(()=>localStorage.getItem("adminConsole_editorMode")||"visual"),[U,V]=h.useState(()=>localStorage.getItem("adminConsole_activeTab")||"pages"),[Y,_e]=h.useState(()=>localStorage.getItem("adminConsole_pageTab")||"index"),[ne,ye]=h.useState(()=>localStorage.getItem("adminConsole_jsonTab")||"index"),[o,z]=h.useState(C),[le,q]=h.useState(null),[T,D]=h.useState(!1),[fe,Ae]=h.useState(!1);h.useEffect(()=>{localStorage.setItem("adminConsole_editorMode",s)},[s]),h.useEffect(()=>{localStorage.setItem("adminConsole_activeTab",U)},[U]),h.useEffect(()=>{localStorage.setItem("adminConsole_pageTab",Y)},[Y]),h.useEffect(()=>{localStorage.setItem("adminConsole_jsonTab",ne)},[ne]),h.useEffect(()=>{const u=[];for(let j=0;j<localStorage.length;j++){const M=localStorage.key(j);M&&(M.startsWith("visual_")||M.startsWith("admin_")||M.startsWith("wysiwyg_"))&&u.push(M)}u.forEach(j=>localStorage.removeItem(j))},[]);const me=async u=>{try{const j=o[u];if(JSON.parse(j),!(await fetch(Te.saveJson,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageId:u,content:JSON.parse(j)})})).ok)throw new Error("Erro ao salvar");q({type:"success",text:`Salvo: ${g.find(l=>l.id===u)?.name}`}),setTimeout(()=>q(null),2e3)}catch(j){q({type:"error",text:`Erro: ${j}`})}},E=u=>{const j=g.find(d=>d.id===u);if(!j)return;const M=new Blob([o[u]],{type:"application/json"}),l=URL.createObjectURL(M),p=document.createElement("a");p.href=l,p.download=j.file,p.click()};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(ke,{children:e.jsxs(Ee,{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Console"}),le&&e.jsx(Le,{className:"mb-4",children:e.jsx(Fe,{children:le.text})}),e.jsxs(ze,{value:s,onValueChange:u=>F(u),children:[e.jsxs(Ie,{children:[e.jsxs(be,{value:"visual",className:"min-w-[180px] px-6 py-3",children:[e.jsx(it,{className:"w-4 h-4 mr-2"}),"Visual"]}),e.jsxs(be,{value:"json",className:"min-w-[180px] px-6 py-3",children:[e.jsx(gs,{className:"w-4 h-4 mr-2"}),"JSON"]})]}),e.jsx(ve,{value:"visual",children:e.jsxs(ze,{value:U,onValueChange:V,children:[e.jsxs(Ie,{children:[e.jsx(be,{value:"pages",className:"min-w-40 px-6 py-2.5",children:"Pages"}),e.jsx(be,{value:"blog",className:"min-w-40 px-6 py-2.5",children:"Blog"})]}),e.jsx(ve,{value:"pages",children:e.jsxs(ze,{value:Y,onValueChange:_e,children:[e.jsx(Ie,{className:"flex-wrap",children:g.map(u=>e.jsx(be,{value:u.id,className:"min-w-[140px] px-5 py-2",children:u.name},u.id))}),g.map(u=>e.jsx(ve,{value:u.id,children:e.jsx(ro,{pageId:u.id,pageName:u.name,pageComponent:u.component})},u.id))]})}),e.jsx(ve,{value:"blog",children:e.jsx(mo,{})})]})}),e.jsx(ve,{value:"json",children:e.jsxs(ze,{value:ne,onValueChange:ye,children:[e.jsx(Ie,{className:"flex-wrap",children:g.map(u=>e.jsx(be,{value:u.id,className:"min-w-[140px] px-5 py-2",children:u.name},u.id))}),g.map(u=>e.jsx(ve,{value:u.id,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{onClick:()=>me(u.id),children:[e.jsx(lo,{className:"w-4 h-4 mr-2"}),"Save"]}),e.jsxs(R,{variant:"outline",onClick:()=>E(u.id),children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Download"]})]}),e.jsx(qe,{rows:30,value:o[u.id],onChange:j=>z(M=>({...M,[u.id]:j.target.value})),className:"font-mono text-sm"})]})},u.id))]})})]})]})})})})}export{jo as default};
